import{X as I,G as W,r as h,j as e}from"./app-CzNOCBCP.js";import{M as H}from"./Modal-Deuc3IVm.js";import{S as w}from"./react-select.esm-ISyukIyw.js";import"./transition-DY9qfS6v.js";const $=()=>e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"2.5",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})}),P=({errors:u,onDismiss:p})=>{const g=Object.values(u).flat();return g.length===0?null:e.jsx("div",{className:"fixed top-4 right-4 z-50 max-w-md animate-slide-in",children:e.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 rounded-lg shadow-xl p-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("svg",{className:"h-5 w-5 text-red-500 mt-0.5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),e.jsxs("div",{className:"ml-3 flex-1",children:[e.jsxs("h3",{className:"text-sm font-bold text-red-800 uppercase tracking-wide",children:["Validation Error",g.length>1?"s":""]}),e.jsx("ul",{className:"mt-1 text-sm text-red-700 list-disc list-inside space-y-1",children:g.map((b,j)=>e.jsx("li",{children:b},j))})]}),e.jsx("button",{onClick:p,className:"ml-4 text-red-400 hover:text-red-600",children:e.jsx($,{})})]})})})};function Y({show:u,onClose:p,drivers:g=[],vehicles:b=[],trips:j=[]}){const{departments:d=[]}=I().props,{data:r,setData:l,post:L,processing:S,errors:s,reset:M}=W({tickNo:"",deptCode:d.length>0?d[0].code:"001",driver_id:"",vehicle_id:"",passenger:"",place:"",purpose:"",chargetoproject:"",fuel_type:"",liters:"",trip_start:"",trip_end:"",status:"booked"}),[A,v]=h.useState(!1),[N,y]=h.useState(null),[k,C]=h.useState(null);h.useEffect(()=>{if(d.length>0&&!k){const t=d[0];C(t),l("deptCode",t.code)}},[d]),h.useEffect(()=>{if(!u||!r.deptCode)return;const a=`MEO-${new Date().getFullYear()}-${r.deptCode}-`,i=j.filter(x=>{var m;return(m=x.tickNo)==null?void 0:m.startsWith(a)})||[];let c=1;if(i.length>0){const x=i.map(m=>parseInt(m.tickNo.split("-").pop(),10)||0).filter(m=>m>0);x.length&&(c=Math.max(...x)+1)}const f=c.toString().padStart(2,"0");l("tickNo",`${a}${f}`)},[u,r.deptCode,j]),h.useEffect(()=>{if(Object.keys(s).length>0){v(!0);const t=setTimeout(()=>v(!1),7e3);return()=>clearTimeout(t)}},[s]);const _=g.map(t=>({value:t.id,label:`${t.firstname} ${t.middlename||""} ${t.lastname}`.trim(),status:t.status})),D=b.map(t=>{var a;return{value:t.id,label:`${t.plate_number} â€” ${((a=t.vehicle_type)==null?void 0:a.vehicle_type_name)||t.model||"Unknown"}`,status:t.status,raw:t}}),B=d.map(t=>({value:t.code,label:`${t.code} - ${t.name}`,raw:t})),E=t=>{if(!t){l(f=>({...f,vehicle_id:"",fuel_type:""})),y(null);return}const a=t.raw;l(f=>{var x;return{...f,vehicle_id:a.id,fuel_type:((x=a.vehicle_type)==null?void 0:x.category)||a.fuel_type||""}});let i="",c="";switch(a.status){case"available":i="Available",c="text-emerald-600 bg-emerald-50";break;case"on trip":i="Currently On Trip",c="text-amber-600 bg-amber-50";break;case"booked":i="Booked / Reserved",c="text-red-600 bg-red-50";break;default:i=`Status: ${a.status||"Unknown"}`,c="text-gray-600 bg-gray-100"}y({text:i,color:c})},O=t=>{if(!t){if(d.length>0){const a=d[0];C(a),l("deptCode",a.code)}return}C(t.raw),l("deptCode",t.value)},T=t=>{t.preventDefault(),L(route("trips.store"),{onSuccess:()=>{M(),y(null),p(),v(!1)}})},n=({children:t})=>e.jsx("label",{className:"text-[11px] font-black uppercase tracking-wider text-[#1B4332] mb-2 block",children:t}),F="w-full bg-gray-50 border border-gray-200 rounded py-2.5 px-4 text-sm font-medium text-gray-700 focus:ring-2 focus:ring-[#1B4332]/30 focus:border-[#1B4332] transition-all placeholder:text-gray-400",o=t=>`${F} ${s[t]?"border-red-400 bg-red-50/60":""}`,R={control:(t,a)=>({...t,backgroundColor:s.deptCode?"#fef2f2":"#f9fafb",borderColor:a.isFocused?"#1B4332":s.deptCode?"#ef4444":"#d1d5db",borderRadius:"0.375rem",boxShadow:"none",minHeight:"42px",fontSize:"0.875rem"}),option:(t,a)=>({...t,backgroundColor:a.isSelected?"#1B4332":a.isFocused?"#f0fdf4":"white",color:a.isSelected?"white":"#111827",fontSize:"0.875rem",padding:"10px 12px"}),menu:t=>({...t,borderRadius:"0.5rem",boxShadow:"0 10px 15px -3px rgba(0,0,0,0.1)",zIndex:9999}),singleValue:t=>({...t,color:"#1B4332",fontWeight:"500"})},z=t=>({control:(a,i)=>({...a,backgroundColor:s[t]?"#fef2f2":"#f9fafb",borderColor:i.isFocused?"#1B4332":s[t]?"#ef4444":"#d1d5db",borderRadius:"0.375rem",boxShadow:"none",minHeight:"42px",fontSize:"0.875rem","&:hover":{borderColor:s[t]?"#ef4444":"#1B4332"}}),option:(a,i)=>({...a,backgroundColor:i.isSelected?"#1B4332":i.isFocused?"#f0fdf4":"white",color:i.isSelected?"white":"#111827",fontSize:"0.875rem",padding:"10px 12px"}),menu:a=>({...a,borderRadius:"0.5rem",boxShadow:"0 10px 15px -3px rgba(0,0,0,0.1)",zIndex:9999})}),V=t=>{const a=t.raw;return e.jsx("div",{className:"flex flex-col",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-mono font-bold text-gray-900",children:a.code}),e.jsx("span",{className:"text-gray-700",children:"-"}),e.jsx("span",{className:"font-medium text-gray-900",children:a.name})]})})};return e.jsxs(e.Fragment,{children:[A&&e.jsx(P,{errors:s,onDismiss:()=>v(!1)}),e.jsxs(H,{show:u,onClose:p,maxWidth:"2xl",children:[e.jsx("div",{className:"fixed inset-0 bg-[#081c15]/70 backdrop-blur-sm -z-10","aria-hidden":"true"}),e.jsxs("form",{onSubmit:T,className:"bg-white shadow-2xl flex flex-col max-h-[92vh] rounded-xl overflow-hidden relative z-10",children:[e.jsxs("div",{className:"bg-[#1B4332] px-8 py-5 flex justify-between items-center shrink-0",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-[9px] font-black tracking-[0.35em] text-[#A3C1AD] uppercase opacity-80",children:"Security Protocol"}),e.jsx("h3",{className:"text-xl font-black text-white uppercase italic tracking-tight mt-0.5",children:"Dispatch Manifest"})]}),e.jsx("button",{type:"button",onClick:p,className:"text-[#A3C1AD] hover:text-white",children:e.jsx($,{})})]}),e.jsxs("div",{className:"p-8 overflow-y-auto space-y-7",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-px w-10 bg-blue-500/70"}),e.jsx("h4",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-[0.3em]",children:"Identification"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[e.jsxs("div",{children:[e.jsx(n,{children:"Official Ticket Number"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",className:"w-full font-mono text-lg font-bold text-blue-700 bg-blue-50/40 border-2 border-blue-300 rounded py-3 px-4 cursor-not-allowed",value:r.tickNo,readOnly:!0,disabled:!0}),e.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:e.jsx("svg",{className:"w-5 h-5 text-blue-500/70",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})})]})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Department Code"}),d.length>0?e.jsxs(e.Fragment,{children:[e.jsx(w,{options:B,styles:R,value:B.find(t=>t.value===r.deptCode)||null,onChange:O,placeholder:"Select department...",formatOptionLabel:V,isClearable:!1,isSearchable:!0}),k&&e.jsx("div",{className:"mt-2 text-xs text-gray-600 bg-gray-50 p-2 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),e.jsx("span",{className:"font-medium",children:k.name})]})})]}):e.jsx("div",{className:"text-sm text-gray-500 italic p-3 bg-gray-50 rounded-lg",children:"Loading departments..."}),s.deptCode&&e.jsx("p",{className:"text-red-600 text-xs mt-1.5 font-medium",children:s.deptCode})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-px w-10 bg-[#1B4332]/70"}),e.jsx("h4",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-[0.3em]",children:"Resources"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[e.jsxs("div",{children:[e.jsx(n,{children:"Vehicle Unit (All statuses shown)"}),e.jsx(w,{options:D,styles:z("vehicle_id"),value:D.find(t=>t.value===r.vehicle_id)||null,onChange:E,placeholder:"Select vehicle...",isClearable:!0,isSearchable:!0}),s.vehicle_id&&e.jsx("p",{className:"text-red-600 text-xs mt-1.5 font-medium",children:s.vehicle_id}),N&&e.jsxs("div",{className:`mt-2 inline-flex items-center px-3 py-1 rounded-full text-xs font-medium ${N.color}`,children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-current mr-1.5"}),N.text]})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Assigned Driver"}),e.jsx(w,{options:_,styles:z("driver_id"),value:_.find(t=>t.value===r.driver_id)||null,onChange:t=>l("driver_id",t?t.value:""),placeholder:"Select driver...",isClearable:!0,isSearchable:!0}),s.driver_id&&e.jsx("p",{className:"text-red-600 text-xs mt-1.5 font-medium",children:s.driver_id})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-px w-10 bg-[#A3C1AD]/70"}),e.jsx("h4",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-[0.3em]",children:"Mission Logistics"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[e.jsxs("div",{children:[e.jsx(n,{children:"Authorized Passenger"}),e.jsx("input",{type:"text",className:o("passenger"),value:r.passenger,onChange:t=>l("passenger",t.target.value)}),s.passenger&&e.jsx("p",{className:"text-red-600 text-xs mt-1.5 font-medium",children:s.passenger})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Destination (Place)"}),e.jsx("input",{type:"text",className:o("place"),value:r.place,onChange:t=>l("place",t.target.value)}),s.place&&e.jsx("p",{className:"text-red-600 text-xs mt-1.5 font-medium",children:s.place})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[e.jsxs("div",{children:[e.jsx(n,{children:"Project Charge Code"}),e.jsx("input",{type:"text",className:o("chargetoproject"),value:r.chargetoproject,onChange:t=>l("chargetoproject",t.target.value)}),s.chargetoproject&&e.jsx("p",{className:"text-red-600 text-xs mt-1.5 font-medium",children:s.chargetoproject})]}),e.jsxs("div",{className:"col-span-full",children:[e.jsx(n,{children:"Mission Purpose"}),e.jsx("textarea",{className:`${o("purpose")} resize-none`,rows:2,value:r.purpose,onChange:t=>l("purpose",t.target.value),placeholder:"Brief description of mission objective..."}),s.purpose&&e.jsx("p",{className:"text-red-600 text-xs mt-1.5 font-medium",children:s.purpose})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-px w-10 bg-orange-500/60"}),e.jsx("h4",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-[0.3em]",children:"Operational Data"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-5",children:[e.jsxs("div",{children:[e.jsx(n,{children:"Fuel Type"}),e.jsx("input",{type:"text",className:o("fuel_type"),value:r.fuel_type,onChange:t=>l("fuel_type",t.target.value),placeholder:"Diesel / Gasoline / etc."}),s.fuel_type&&e.jsx("p",{className:"text-red-600 text-xs mt-1.5 font-medium",children:s.fuel_type})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Liters Allocated"}),e.jsx("input",{type:"number",step:"0.01",min:"0",className:o("liters"),value:r.liters,onChange:t=>l("liters",t.target.value)}),s.liters&&e.jsx("p",{className:"text-red-600 text-xs mt-1.5 font-medium",children:s.liters})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Initial Status"}),e.jsxs("select",{className:o("status"),value:r.status,onChange:t=>l("status",t.target.value),children:[e.jsx("option",{value:"booked",children:"Booked"}),e.jsx("option",{value:"on trip",children:"On Trip"}),e.jsx("option",{value:"finished",children:"Finished"})]}),s.status&&e.jsx("p",{className:"text-red-600 text-xs mt-1.5 font-medium",children:s.status})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-5",children:[e.jsxs("div",{children:[e.jsx(n,{children:"Estimated Time of Departure (ETD)"}),e.jsx("input",{type:"datetime-local",className:o("trip_start"),value:r.trip_start,onChange:t=>l("trip_start",t.target.value)}),s.trip_start&&e.jsx("p",{className:"text-red-600 text-xs mt-1.5 font-medium",children:s.trip_start})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Estimated Time of Arrival (ETA)"}),e.jsx("input",{type:"datetime-local",className:o("trip_end"),value:r.trip_end,onChange:t=>l("trip_end",t.target.value)}),s.trip_end&&e.jsx("p",{className:"text-red-600 text-xs mt-1.5 font-medium",children:s.trip_end})]})]})]})]}),e.jsxs("div",{className:"bg-gray-50 px-8 py-5 border-t border-gray-200 flex flex-col sm:flex-row-reverse gap-4 shrink-0",children:[e.jsx("button",{type:"submit",disabled:S,className:"bg-[#1B4332] text-white px-10 py-3.5 rounded-lg font-bold uppercase text-sm shadow-md disabled:opacity-50 hover:bg-[#2d5a47] transition-colors",children:S?"Authorizing...":"Authorize Dispatch"}),e.jsx("button",{type:"button",onClick:p,className:"px-8 py-3.5 text-sm font-bold text-gray-500 uppercase hover:text-red-700 transition-colors",children:"Cancel"})]})]})]}),e.jsx("style",{children:`
                @keyframes slide-in {
                    from { transform: translateX(120%); opacity: 0; }
                    to   { transform: translateX(0);    opacity: 1; }
                }
                .animate-slide-in { animation: slide-in 0.4s ease-out; }
            `})]})}export{Y as default};
